import{j as n,r as c,D as N,R as F,C as R,S as j,G as b,a as p,B as D,b as O,A as y,c as A}from"./index-DkaJZGnT.js";import{u as w,g as P,A as I,a as M}from"./AGGridHeader-CximXkho.js";function S({title:e,options:t,selectedOptions:a,onChange:s}){return n.jsxs(n.Fragment,{children:[n.jsxs("strong",{children:[e,":"]}),n.jsx("div",{className:"filter-row",children:Object.entries(t).map(([i,d])=>n.jsxs("label",{children:[n.jsx("input",{type:"checkbox",value:d,checked:a.includes(d),onChange:s}),d]},i))})]})}function _(e){var o;const{showTooltip:t,tooltipPosition:a,targetRef:s,tooltipRef:i,handleMouseEnter:d,handleMouseLeave:l}=w({elementForListeners:e.eGridCell,horizontalCenter:!1,gridDiv:(o=e.eGridCell)==null?void 0:o.closest(".ag-root-wrapper")}),u=c.useMemo(()=>{var g;if(!((g=e.data)!=null&&g.versions)||!e.deviceVersion)return"";const h=e.data.versions.find(f=>f.version===e.deviceVersion);if(h!=null&&h.devices){const f=h.devices.map(C=>N[C]||C);return Array.from(new Set(f)).join(", ")}return""},[e.data,e.deviceVersion]),m=P(),r=t&&u.length>0;return n.jsxs("button",{ref:s,className:"cell-not-button",style:{display:"flex"},onMouseEnter:d,onMouseLeave:l,children:[e.value&&n.jsx("img",{className:"tama-image-small",src:"/tamagotchi-resources/tamagotchi-images/"+e.value,alt:e.value}),m&&F.createPortal(n.jsx("div",{ref:i,className:"tooltip-css",style:{top:a.top,left:a.left,visibility:r?"visible":"hidden",opacity:r?1:0,pointerEvents:r?"auto":"none"},children:u}),m)]})}const G=c.memo(_);function L(e,t){const a=e.find(s=>s.version===t);return a?a.sprite:null}function V(e,t){const[a,s]=R[e]??["",""];return{headerName:a,field:t,headerComponent:I,headerComponentParams:{tooltip:s,useEllipses:!1},filter:!1,getQuickFilterText:()=>"",resizable:!1,sortable:!1,cellRenderer:G,cellRendererParams:{deviceVersion:e},width:52}}function B(e,t,a){a.forEach(({version:s,field:i})=>{e[i]=L(t,s)})}function k(e,t){return e.length>0&&e.length<Object.keys(t).length}function E(e){return e.length===0}function T(e,t,a,s,i){if(e.length===0)return!1;const d=Array.from(new Set(e.flatMap(s).filter(l=>l!=null&&l!=="")));return t.length===Object.keys(a).length?!0:t.length===0?!1:i?i(t,d):d.some(l=>t.includes(l))}function W(e,t,a){return t?[...a,e]:a.filter(s=>s!==e)}function H(){const[e,t]=c.useState({device:Object.values(p),gender:Object.values(b),stages:Object.values(j)}),a=c.useCallback((r,o)=>{const{value:h,checked:g}=r.target;t(f=>({...f,[o]:W(h,g,f[o])}))},[]),s=c.useCallback(()=>k(e.device,p)||E(e.device)||k(e.gender,b)||E(e.gender)||k(e.stages,j)||E(e.stages),[e]),i=c.useCallback((r,o)=>{const h=r.includes(p.blackAndWhite),g=r.includes(p.color),f=o.some(v=>D.includes(v)),C=o.some(v=>O.includes(v));return h&&f||g&&C},[]),d=c.useCallback(r=>T(r,e.device,p,o=>o.version,i),[e.device,i]),l=c.useCallback(r=>T(r,e.gender,b,o=>o.gender),[e.gender]),u=c.useCallback(r=>{const o=r.some(g=>g.stage!==void 0&&g.stage!==null&&g.stage!=="");return r.length>0&&!o?!0:T(r,e.stages,j,g=>g.stage)},[e.stages]),m=c.useCallback(r=>{if(!r.data)return!1;const o=r.data.versions;return d(o)&&l(o)&&u(o)},[d,l,u]);return{handleCheckboxChange:a,isFilterPresent:s,doesFilterPass:m,selectedDeviceOptions:e.device,selectedGenderOptions:e.gender,selectedStageOptions:e.stages}}function $(e){var s,i,d,l,u;let t="#696969";((s=e.data)==null?void 0:s.gender)==="Female"?t="#FF69B4":((i=e.data)==null?void 0:i.gender)==="Male"&&(t="#1E90FF");const a=(d=e.data)==null?void 0:d.image;return n.jsxs("a",{href:(l=e.data)==null?void 0:l.link,target:"_blank",rel:"noopener noreferrer",style:{display:"flex",alignItems:"center"},children:[a&&n.jsx("img",{src:"/tamagotchi-resources/tamagotchi-images/"+a,alt:(u=e.data)==null?void 0:u.name,className:e.isPhone?"tama-image-tiny":"tama-image-small",style:{margin:"0 5px"}}),n.jsx("span",{style:{color:t,textDecoration:"underline",textAlign:"left"},children:e.value})]})}const z=c.memo($);function U(e,t){return c.useMemo(()=>{const a={headerName:"Tamagotchi",field:"name",cellRenderer:z,cellRendererParams:{isPhone:e},pinned:"left",unSortIcon:!0,width:e?150:200,cellStyle:{justifyContent:"left"}},s=y.filter(i=>i.type==="blackAndWhite"&&t.includes(p.blackAndWhite)||i.type==="color"&&t.includes(p.color)).map(i=>V(i.version,i.field));return[a,...s]},[e,t])}function q(){const[e,t]=c.useState([]);return c.useEffect(()=>{async function a(){try{const s=await fetch("/tamagotchi-resources/tamagotchi-data.json");if(!s.ok){const l=`HTTP error! status: ${s.status}`;console.error("Failed to fetch data:",l),t([]);return}const i=await s.json(),d=Object.entries(i).map(([l,u])=>{const m=u.versions||[],r={image:u.image,name:l,link:u.link,gender:u.gender,versions:m};return B(r,m,y),r});t(d)}catch(s){console.error("An unexpected error occurred while fetching data:",s),t([])}}a().then()},[]),e}function K({displayFilters:e,themeMode:t,isPhone:a}){const{handleCheckboxChange:s,isFilterPresent:i,doesFilterPass:d,selectedDeviceOptions:l,selectedGenderOptions:u,selectedStageOptions:m}=H(),r=c.useRef(null),o=U(a,l),h=q(),[g,f]=c.useState(""),C=c.useCallback(x=>{f(x.target.value)},[]),v=c.useCallback(()=>{f("")},[]);return c.useEffect(()=>{var x;(x=r.current)!=null&&x.api&&r.current.api.onFilterChanged()},[l,u,m]),n.jsxs("div",{className:"padding-css flex-column-1",children:[e&&n.jsx("div",{style:{paddingBottom:"1em"},children:n.jsxs("div",{className:"filter-grid",children:[n.jsx("strong",{children:"Search:"}),n.jsxs("div",{className:"search-input-wrapper",children:[n.jsx("input",{type:"text",value:g,onChange:C,className:"search-field"}),g&&n.jsx("button",{className:"clear-button",onClick:v,children:n.jsx(A,{})})]}),n.jsx(S,{title:"Devices",options:p,selectedOptions:l,onChange:x=>s(x,"device")}),n.jsx(S,{title:"Gender",options:b,selectedOptions:u,onChange:x=>s(x,"gender")}),n.jsx(S,{title:"Stages",options:j,selectedOptions:m,onChange:x=>s(x,"stages")})]})}),n.jsxs("div",{className:"flex-column-1","data-ag-theme-mode":t,children:[n.jsx("div",{style:{flex:1},children:n.jsx(M,{ref:r,rowData:h,columnDefs:o,isExternalFilterPresent:i,doesExternalFilterPass:d,quickFilterText:g,gridOptions:{enableCellTextSelection:!0,accentedSort:!0,columnHoverHighlight:!0,rowHeight:52,rowBuffer:30}})}),a&&n.jsx("strong",{style:{textAlign:"right"},children:"This site is best viewed in landscape mode"}),n.jsxs("cite",{style:{textAlign:"right"},children:["Images and information are from the ",n.jsx("a",{href:"https://tamagotchi.fandom.com/wiki/Main_Page",target:"_blank",rel:"noopener noreferrer",children:"Tamagotchi Wiki"})]})]})]})}export{K as default};
